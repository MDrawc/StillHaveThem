function changeTheme(shared) {
    var cookie = shared ? 'sh_theme' : 'theme';
    var $switch = $('#change-theme');
    $switch.off();
    $switch.click(function() {
        $(".g-right").removeClass('move');
        var $style_link = $('#theme-control');
        var $favicon_link = $('#favicon-control');
        if (Cookies.get(cookie) == 'theme_dark') {
            $(this).removeClass('active');
            Cookies.set(cookie, 'theme_default', {
                expires: 365
            });
            $style_link.replaceWith('<%= stylesheet_link_tag "theme_default", id: "theme-control" %>');
            $favicon_link.replaceWith('<%= favicon_link_tag asset_path("favicon.ico"), id: "favicon-control" %>');
        } else {
            $(this).addClass('active');
            Cookies.set(cookie, 'theme_dark', {
                expires: 365
            });
            $style_link.replaceWith('<%= stylesheet_link_tag "theme_dark", id: "theme-control" %>');
            $favicon_link.replaceWith('<%= favicon_link_tag asset_path("favicon_dark.ico"), id: "favicon-control" %>');
        }
    });
}

function changeThemeLp() {

    function changeImages(from_to) {
        var $images = $('img');
        $images.each(function() {
            var attr = $(this).attr('src');
            $(this).attr('src', attr.replace(from_to[0], from_to[1]));
            attr = $(this).attr('srcset');
            $(this).attr('srcset', attr.replace(from_to[0], from_to[1]));
        });
    }

    var $switch = $('#change-theme-lp');
    $switch.off();
    $switch.click(function() {
        var $style_link = $('#theme-control');
        var $favicon_link = $('#favicon-control');
        if (Cookies.get('theme') == 'theme_dark') {
            $(this).removeClass('active');
            Cookies.set('theme', 'theme_default', {
                expires: 365
            });
            Cookies.set('sh_theme', 'theme_default', {
                expires: 365
            });

            $style_link.replaceWith('<%= stylesheet_link_tag "theme_default", id: "theme-control" %>');
            $favicon_link.replaceWith('<%= favicon_link_tag asset_path("favicon.ico"), id: "favicon-control" %>');
            changeImages(['_dark.png', '.png']);
        } else {
            $(this).addClass('active');
            Cookies.set('theme', 'theme_dark', {
                expires: 365
            });
            Cookies.set('sh_theme', 'theme_dark', {
                expires: 365
            });
            $style_link.replaceWith('<%= stylesheet_link_tag "theme_dark", id: "theme-control" %>');
            $favicon_link.replaceWith('<%= favicon_link_tag asset_path("favicon_dark.ico"), id: "favicon-control" %>');
            changeImages(['.png', '_dark.png']);
        }
    });
}
