<% i_settings = 'mode: none; bg-close: true' %>
<div id="i-<%= game['id'] %>" uk-offcanvas="<%= i_settings %>">
    <div class="uk-offcanvas-bar <%= game['id'] %>">
        <!-- <button class="uk-offcanvas-close" type="button" uk-close></button> -->
        <!-- TITLE & RELEASE YEAR -->
        <h3 id="info-title"><%= game['name'] %>
        <% if game["first_release_date"]%>
        <span id="info-year">(<%= Time.at(game["first_release_date"]).year %>)</span>
        <% else %>
        <% end %>
        </h3>
        <!-- DEVELOPER -->
        <% if devs = get_developer(game) %>
        <p id="info-by">by <%= devs.join(', ') %></p>
        <% end %>
        <!-- COVER -->
        <%= image_tag('', class: 'game-cover info-cover', width: options[:width], 'data-src' => cover_url, alt: game['name'], 'draggable' => 'false', 'uk-img' => "target: #gc-#{ game['id'] }" ) if cover_url %>
        <!-- PLATFORMS -->
        <% if platforms = game["platforms"] %>
        <p id="info-platform">
            <% platforms.each do |platform| %>
            <span>
                <% unless platform == platforms.last %>
                <%= platform['name'] + ', ' %>
                <% else %>
                <%= platform['name'] %>
                <% end %>
            </span>
            <% end %>
        </p>
        <% end %>
        <!-- SUMMARY -->
        <% if summary = get_summary(game, 280, 50) %>
        <p id="info-summary"><%= summary[:start] %><% if summary[:end] %><span class="dots" id="dots-<%= game['id'] %>"><%= summary[:span] %><button class="uk-icon-link uk-icon ms-b-down" onclick="myFunction(<%= game['id'] %>)" uk-icon="icon: triangle-down"></button></span> <span id="more-<%= game['id'] %>" class="more"><%= summary[:end] %><button class="uk-icon-link uk-icon ms-b-up" onclick="myFunction(<%= game['id'] %>)" uk-icon="icon: triangle-up"></button></span>
    </p>
    <script>
    function myFunction(id) {
    var dots = document.getElementById("dots-" + id);
    var moreText = document.getElementById("more-" + id);
    if (dots.style.display === "none") {
    dots.style.display = "inline";
    moreText.style.display = "none";
    } else {
    dots.style.display = "none";
    moreText.style.display = "inline";
    }
    }
    </script>
    <% end %>
    <% end %>
    <!-- SLIDESHOW -->
    <% if urls = get_screenshots(game) %>
    <div class="uk-position-relative md-slideshow" uk-slideshow="animation: fade" uk-lightbox="toggle: .uk-position-cover; animation: fade">
        <ul class="uk-slideshow-items">
            <% no_of_screens = 0 %>
            <% urls.each_with_index do |url, i| %>
            <li>
                <% img_target = (i == 0) ? "target: #gc-#{ game['id'] }" : "target: #i-#{ game['id'] }" %>
                <%= image_tag('', 'data-src' => url[:small], alt: game['name'], 'uk-cover' => '', 'uk-img' => img_target ) %>
                <%= content_tag(:a, '', href: url[:big], class: 'uk-position-cover') %>
            </li>
            <% no_of_screens += 1 %>
            <% end %>
        </ul>
        <!-- SLIDESHOW NAVIGATION -->
        <% if no_of_screens > 1 %>
        <table class="t-scr">
            <tr>
                <td class="arrow-left">
                    <a class="uk-icon-link" href="#" uk-slideshow-item="previous" uk-icon='chevron-left'>
                    </td>
                    <td>
                        <div class="hor-cen-list">
                            <ul id="screen-nav">
                                <% no_of_screens.times do |t| %>
                                <li uk-slideshow-item="<%= t %>"><%= content_tag(:a, '', href: '#',
                                class: 'uk-icon-link', 'uk-icon' => 'image') %></li>
                                <% end %>
                            </ul>
                        </div>
                    </td>
                    <td class="arrow-right">
                        <a class="uk-icon-link" href="#" uk-slideshow-item="next" uk-icon='chevron-right'></a>
                    </td>
                </tr>
            </table>
            <% end %>
        </div>
        <% end %>
        <!-- LINKS -->
        <hr>
        <div id="info-links">
            <%= link_to '',"http://www.google.com/search?q=%22#{ game['name'].gsub(' ', '+') }%22+video+game" , class: "ex-link google uk-icon-button uk-margin-small-right", target: "_blank", "uk-icon" => "google" %>
            <%= link_to render('svgs/metacritic_icon'),"https://www.metacritic.com/search/game/#{ game['name'].gsub(' ', '%20') }/results" , class: "ex-link metacritic uk-icon-button uk-margin-small-right", target: "_blank" %>
            <button id='i-flipper-<%= game['id'] %>' class="flip"><%= render 'svgs/flip_icon' %></button>
        </div>
    </div>
</div>
