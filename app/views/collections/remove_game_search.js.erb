var form = '<%= @collection.form %>';
var msg_pos = 'top-right'

// Notifications position depends on offcanvas position
if ($('.uk-offcanvas-container').length) {
    var offc_class = $('.uk-offcanvas-container').attr('class');

    if (offc_class.includes('uk-offcanvas-flip')) {
        msg_pos = 'top-left';
    }
}

UIkit.notification({
    message: $('<div/>').html('<%= @message %>').text(),
    status: 'warning',
    pos: msg_pos,
    timeout: 5000
});

<% if @success %>

    var game_id = '<%= @game.igdb_id %>';

    // Show add form and hide remove form for Wishlist and Played
    if ((form === 'wishlist') || (form === 'played')) {
        var element = "#add-" + form + "-form-" + game_id;
        $(element).show();
        element = element.replace("add", "remove");
        $(element).hide();

    } else if ((form === 'collection') || (form === 'custom')) {

        // Render games already in My Collection and Custom Collections
        var drop_element = "#add-" + form + "-form-" + game_id;
        var already = "#add-" + form + "-form-" + game_id + " .already-in";

        if (form === 'collection') {
            var proxy = "<%= escape_javascript(render partial: 'cover_view/already_in_collection', locals: { collection: @collection, game_name: @game.name, igdb_id: @game.igdb_id }) %>";
        } else {
            var proxy = "<%= escape_javascript(render partial: 'cover_view/already_in_custom', locals: { game_name: @game.name, igdb_id: @game.igdb_id }) %>";
        }
        $(already).html(proxy);

        // Change underlight in My collection and Custom Collection
        <% if @all_deleted %>
            var button = "#add-" + form + "-" + game_id;
            $(button).removeClass('remove');
        <% end %>

        // Reseting error status upon succesful remove
        // - both forms (collection and custom)
        if ($('#add-form-errors').length) {
            var errorsPlace = '#add-' + form + '-form-' + game_id + ' .add-form-errors';
            $(errorsPlace).html("<%= escape_javascript(render partial: 'games/add_form_errors', locals: { errors: [] }) %>");
        }
    }

    // Remove underline from removed game
    <% if @remove_underline %>
    var name_el = '#gs-' + game_id + ' .game-name span'
    $(name_el).removeClass('owned');
    <% end %>

<% end %>
