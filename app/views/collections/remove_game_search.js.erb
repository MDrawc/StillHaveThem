var success = <%= @success %>;
var remove_underline = <%= @remove_underline %>;
var msg_pos = 'top-right'

UIkit.notification({
    message: $('<div/>').html('<%= @message %>').text(),
    status: 'warning',
    pos: msg_pos,
    timeout: 5000
});

if (success) {
    var game_id = '<%= @game.igdb_id %>';
    var x_id = '<%= @x_id %>';
    var new_already = "<%= j(render partial: 'search/already_in', locals: { game_name: @game.name, igdb_id: @game.igdb_id, x_id: @x_id }) %>";

    var view = $('#view-container').attr('view');

    var already, errors_place;

    switch (view) {
        case 'covers':
            already = "#add-form-" + x_id + " .already-in";
            errors_place = '#add-form-' + x_id + ' .add-form-errors';
            break;
        case 'panels':
            already = "#add-form-" + x_id + " .already-in";
            errors_place = '#add-form-' + x_id + ' .add-form-errors';
            break;
        default:
            already = "#t-ops .already-in";
            errors_place = '#t-ops .add-form-errors';
    }

    $(already).html(new_already);
    $(errors_place).html('');

    if (remove_underline) {

        if (view === 'covers') {
            var name_el = $('[id^=gs-' + game_id + ']').find('.game-name span');
            name_el.removeClass('owned');
        }

        $('[id^=add-' + game_id + ']').each(function() {
            var href = $(this).attr('href');
            $(this).attr('href', href.replace('true', 'false'));
            $(this).attr('uk-icon', 'plus');
        });
    }
}
