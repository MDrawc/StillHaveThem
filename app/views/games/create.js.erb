var x_id = '<%= @x_id %>';
var game_id = '<%= @game_igdb_id %>';
var msg = '<%= @message %>';
var view = $('#view-container').attr('view');
var msg_pos = 'top-right';
var success = <%= @errors.empty? %>;

if (msg) {
    UIkit.notification({
        message: $('<div/>').html(msg).text(),
        pos: msg_pos,
        timeout: 5000
    });
}

if (success) {

    Cookies.set('last_coll', '<%= @collection.id %>')
    switch (view) {
        case 'covers':
            var drop_element = "#add-form-" + x_id;
            UIkit.dropdown(drop_element).hide();
            var name_el = $('[id^=gs-' + game_id + ']').find('.game-name span');
            name_el.addClass('owned');
            break;
        case 'panels':
            var drop_element = "#add-form-" + x_id;
            UIkit.dropdown(drop_element).hide();
            break;
        default:
            UIkit.modal("#t-ops").hide();
    }

    $('[id^=add-' + game_id + ']').each(function() {
        var href = $(this).attr('href');
        $(this).attr('href', href.replace('false', 'true'));
        $(this).attr('uk-icon', 'check');
    });

} else {

    var errors = "<%= j(render partial: 'add_form_errors', locals: { errors: @errors }) %>";

    switch (view) {
        case 'list':
            var element = "#t-ops .add-form-errors";
            $(element).html(errors);
            resetFormErrors('list', x_id)
            break;
        default:
            var element = "#add-form-" + x_id + " .add-form-errors";
            $(element).html(errors);
            resetFormErrors('add', x_id)
    }
}
